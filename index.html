<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Materiales - Deck Heroes</title>

    <!-- Hojas de estilo -->
    <link rel="stylesheet" href="estilos/principal.css">
    <link rel="stylesheet" href="estilos/tablas.css">
    <link rel="stylesheet" href="estilos/modales.css">
    <link rel="stylesheet" href="estilos/galeria.css">
    <link rel="stylesheet" href="estilos/responsive.css">

    <style>
        /* Nuevos estilos para tabla ARTE */
        #arte-table table {
            width: 100%;
            border-collapse: collapse;
        }

        #arte-table th,
        #arte-table td {
            padding: 8px;
            border: 1px solid #ddd;
            text-align: center;
        }

        #arte-table td {
            vertical-align: middle;
        }

        #arte-table img {
            width: 33px;
            height: auto;
            display: block;
            margin: 0 auto;
        }

        /* === ESTILOS TOAST === */
        #toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column-reverse;
            gap: 10px;
        }

        .toast {
            min-width: 250px;
            background-color: #333;
            color: white;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            overflow: hidden;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
            max-width: 350px;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        .toast-header {
            padding: 10px 15px;
            background-color: rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .toast-title {
            font-size: 16px;
            font-weight: bold;
        }

        .toast-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }

        .toast-body {
            padding: 15px;
            font-size: 14px;
        }

        /* Tipos de toast */
        .toast-success {
            background-color: #4CAF50;
        }

        .toast-error {
            background-color: #f44336;
        }

        .toast-info {
            background-color: #2196F3;
        }

        .toast-warning {
            background-color: #ff9800;
        }
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1>Gestor de Materiales y de Equipos</h1>
    </header>

    <div class="top-section">
        <div class="left-panel">
            <div class="equipment-image">
                <img id="equipment-img" src="images/botas.png" alt="Equipo" onerror="this.style.display='none'">
            </div>

            <div class="selectors-grid">
                <div class="selector-column">
                    <select id="equipment-select">
                        <option value="Espada">Espada</option>
                        <option value="Pecho">Pecho</option>
                        <option value="Botas">Botas</option>
                        <option value="Casco">Casco</option>
                        <option value="Guantes">Guantes</option>
                        <option value="Cintur√≥n">Cintur√≥n</option>
                    </select>

                    <!-- SELECTOR DE CLASE ACTUALIZADO -->
                    <select id="class-select">
                        <option value="Normal">Normal</option>
                        <option value="Campe√≥n">Campe√≥n</option>
                        <option value="Planewalker">Planewalker</option>
                        <option value="Lord">Lord</option>
                        <option value="Noble Lord">Noble Lord</option>
                    </select>
                </div>

                <div class="selector-column">
                    <select id="level-select">
                        <option value="1">Nivel 1</option>
                        <option value="2">Nivel 2</option>
                        <option value="3">Nivel 3</option>
                        <option value="4">Nivel 4</option>
                        <option value="5">Nivel 5</option>
                    </select>

                    <select id="color-select">
                        <option value="blanco">Blanco</option>
                        <option value="verde">Verde</option>
                        <option value="azul">Azul</option>
                        <option value="morado">Morado</option>
                        <option value="dorado">Dorado</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="right-panel">
            <!-- Contenedor para el FAB de backup, lo genera el JS -->
            <div id="fab-save-menu-container"></div>
        </div>
    </div>

    <!-- Pesta√±as de conversi√≥n -->
    <div class="tabs-container">
        <div class="tab-buttons">
            <button class="tab-button active" data-tab="materials">Materiales</button>
            <button class="tab-button" data-tab="conversion1">>> Verde</button>
            <button class="tab-button" data-tab="conversion2">>> Azul</button>
            <button class="tab-button" data-tab="conversion3">>> Morado</button>
            <button class="tab-button" data-tab="conversionfinal">>> Dorado</button>
            <button class="tab-button conversion-legend-tab" data-tab="conversionlegend" title="Leyenda de Conversi√≥n">
                <i class="info-icon"></i>
            </button>
            <!-- NUEVA PESTA√ëA AYUDA -->
            <button class="tab-button" data-tab="ayuda" title="Ayuda">‚ùì</button>
            <!-- NUEVA PESTA√ëA ARTE -->
            <button class="tab-button" data-tab="arte">ARTE</button>
        </div>
    </div>

    <!-- Contenido de las pesta√±as -->
    <div class="tab-content active" id="materials-tab">
        <div class="materials-table" id="materials-table">
            <!-- Tabla de materiales se generar√° din√°micamente -->
        </div>
    </div>

    <div class="tab-content" id="conversion1-tab">
        <div class="materials-table" id="conversion1-table">
            <!-- Tabla de conversi√≥n 1 se generar√° din√°micamente -->
        </div>
    </div>

    <div class="tab-content" id="conversion2-tab">
        <div class="materials-table" id="conversion2-table">
            <!-- Tabla de conversi√≥n 2 se generar√° din√°micamente -->
        </div>
    </div>

    <div class="tab-content" id="conversion3-tab">
        <div class="materials-table" id="conversion3-table">
            <!-- Tabla de conversi√≥n 3 se generar√° din√°micamente -->
        </div>
    </div>

    <div class="tab-content" id="conversionfinal-tab">
        <div class="materials-table" id="conversionfinal-table">
            <!-- Tabla de conversi√≥n final se generar√° din√°micamente -->
        </div>
    </div>

    <div class="tab-content" id="conversionlegend-tab">
        <div class="conversion-description">
            <p><strong>Tabla de Conversi√≥n de Materiales:</strong></p>
        </div>
        <div class="materials-table" id="conversionlegend-table">
            <table class="conversion-legend-table">
                <thead>
                <tr>
                    <th></th>
                    <th>Blanco</th>
                    <th>Verde</th>
                    <th>Azul</th>
                    <th>Morado</th>
                    <th>Dorado</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th>Dorado</th>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                </tr>
                <tr>
                    <th>Morado</th>
                    <td>0</td>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>4</td>
                </tr>
                <tr>
                    <th>Azul</th>
                    <td>0</td>
                    <td>0</td>
                    <td>1</td>
                    <td>4</td>
                    <td>16</td>
                </tr>
                <tr>
                    <th>Verde</th>
                    <td>0</td>
                    <td>1</td>
                    <td>4</td>
                    <td>16</td>
                    <td>64</td>
                </tr>
                <tr>
                    <th>Blanco</th>
                    <td>1</td>
                    <td>4</td>
                    <td>16</td>
                    <td>64</td>
                    <td>256</td>
                </tr>
                </tbody>
            </table>
            <div class="conversion-notes">
                <p><strong>Equivalencias:</strong></p>
                <ul>
                    <li>4 Blancos = 1 Verde</li>
                    <li>4 Verdes = 1 Azul</li>
                    <li>4 Azules = 1 Morado</li>
                    <li>4 Morados = 1 Dorado</li>
                    <li>16 Blancos = 1 Azul</li>
                    <li>16 Verdes = 1 Morado</li>
                    <li>16 Azules = 1 Dorado</li>
                    <li>64 Blancos = 1 Morado</li>
                    <li>64 Verdes = 1 Dorado</li>
                    <li>256 Blancos = 1 Dorado</li>
                </ul>
            </div>
        </div>
        
        <!-- Layout igual que materiales pero ocultando galer√≠a y USAR -->
        <div class="bottom-section" id="bottom-section-leyenda">
            <!-- Espacio para mantener el layout -->
        </div>

        <div class="bottom-buttons">
            <button id="gallery-button-leyenda" class="gallery-button icon-button" title="Galer√≠a" style="display: none;">
                <span style="font-size: 22px;">üì∑</span>
            </button>
            
            <!-- Espacio para iconos sociales (se usar√°n los originales) -->
            <div class="social-icons-placeholder"></div>
            
            <button id="use-materials-leyenda" class="use-button" style="display: none;">USAR</button>
        </div>
        
        <!-- Bot√≥n Volver a Materiales -->
        <div class="leyenda-back-container">
            <button id="leyenda-back-button" class="back-button">‚Üê Volver a Materiales</button>
        </div>
    </div>

    <!-- NUEVA PESTA√ëA ARTE -->
    <div class="tab-content" id="arte-tab">
        <div class="materials-table" id="arte-table">
            <!-- La tabla de equipos simulados se generar√° din√°micamente aqu√≠ -->
        </div>
        <!-- Bot√≥n Volver a Materiales -->
        <div class="arte-back-container">
            <button id="arte-back-button" class="back-button">‚Üê Volver a Materiales</button>
        </div>
    </div>

    <!-- NUEVA PESTA√ëA AYUDA -->
    <div class="tab-content" id="ayuda-tab">
        <div class="ayuda-container">
            <!-- Tabla de banderas para selecci√≥n de idioma -->
            <div class="language-flags-container">
                <table class="language-flags-table">
                    <tr>
                        <td class="flag-cell">
                            <img src="images/mexico-flag.png" alt="Espa√±ol" class="flag-icon" data-lang="es" title="Espa√±ol">
                        </td>
                        <td class="flag-cell">
                            <img src="images/usa-flag.png" alt="English" class="flag-icon" data-lang="en" title="English">
                        </td>
                        <td class="flag-cell">
                            <img src="images/russia-flag.png" alt="–†—É—Å—Å–∫–∏–π" class="flag-icon" data-lang="ru" title="–†—É—Å—Å–∫–∏–π">
                        </td>
                        <td class="flag-cell">
                            <img src="images/germany-flag.png" alt="Deutsch" class="flag-icon" data-lang="de" title="Deutsch">
                        </td>
                    </tr>
                </table>
            </div>

            <h2>üìñ Gu√≠a de Uso - Gestor de Materiales</h2>
            
            <div class="ayuda-seccion" data-section="whatIsApp">
                <h3>üéØ ¬øQu√© es esta aplicaci√≥n?</h3>
                <p>Esta aplicaci√≥n te ayuda a gestionar materiales y equipos para el juego Deck Heroes. Puedes:</p>
                <ul>
                    <li>Ver materiales necesarios para equipos espec√≠ficos</li>
                    <li>Calcular conversiones entre diferentes calidades de materiales</li>
                    <li>Simular equipos en la pesta√±a ARTE</li>
                    <li>Guardar im√°genes de referencia en la galer√≠a</li>
                </ul>
            </div>

            <div class="ayuda-seccion" data-section="howToUse">
                <h3>‚öôÔ∏è C√≥mo usar los selectores</h3>
                <ol>
                    <li><strong>Equipo:</strong> Selecciona el tipo de equipo (Espada, Pecho, Botas, etc.)</li>
                    <li><strong>Clase:</strong> Elige la clase del equipo (Normal, Campe√≥n, Planewalker, etc.)</li>
                    <li><strong>Nivel:</strong> Selecciona el nivel del equipo (1-5)</li>
                    <li><strong>Color:</strong> Elige la calidad del material (Blanco, Verde, Azul, Morado, Dorado)</li>
                </ol>
                <p><em>üí° Nota: Algunas clases especiales tienen restricciones en niveles y colores permitidos.</em></p>
            </div>

            <div class="ayuda-seccion" data-section="tabs">
                <h3>üìä Pesta√±as disponibles</h3>
                <ul>
                    <li><strong>Materiales:</strong> Muestra los materiales necesarios para el equipo seleccionado</li>
                    <li><strong>>> Verde/Azul/Morado/Dorado:</strong> Calcula conversiones hacia esa calidad</li>
                    <li><strong>Leyenda:</strong> Muestra la tabla de equivalencias entre calidades</li>
                    <li><strong>ARTE:</strong> Simula equipos con diferentes configuraciones</li>
                </ul>
            </div>

            <div class="ayuda-seccion" data-section="gallery">
                <h3>üñºÔ∏è Galer√≠a de im√°genes</h3>
                <p>Puedes guardar im√°genes de referencia para ayudarte a recordar:</p>
                <ul>
                    <li>Haz clic en el bot√≥n de galer√≠a (üì∑) en la parte inferior</li>
                    <li>Usa el bot√≥n "+" para agregar nuevas im√°genes</li>
                    <li>Haz clic en una imagen para verla en pantalla completa</li>
                    <li>Usa el bot√≥n "√ó" para eliminar im√°genes</li>
                </ul>
            </div>

            <div class="ayuda-seccion" data-section="saveLoad">
                <h3>üíæ Guardar y cargar datos</h3>
                <p>Para mantener tus datos seguros:</p>
                <ul>
                    <li>Usa el bot√≥n flotante de guardado (üíæ) en la esquina superior derecha</li>
                    <li>Selecciona "Guardar datos" para descargar un archivo JSON</li>
                    <li>Usa "Cargar datos" para restaurar desde un archivo guardado</li>
                    <li>Usa "Limpiar datos" para borrar todos los datos locales</li>
                    <li><em>‚ö†Ô∏è Importante: Los datos se guardan localmente, no en la nube</em></li>
                </ul>
            </div>

            <div class="ayuda-seccion" data-section="floatingButtons">
                <h3>üìã Botones flotantes</h3>
                <p>En la esquina superior derecha encontrar√°s dos botones flotantes:</p>
                <ul>
                    <li><strong>Bot√≥n superior (üíæ):</strong> Opciones de gesti√≥n de datos (guardar, cargar, limpiar)</li>
                    <li><strong>Bot√≥n inferior (üìã):</strong> Muestra la lista completa de materiales</li>
                    <li><em>üí° Los botones se adaptan autom√°ticamente a diferentes tama√±os de pantalla</em></li>
                </ul>
            </div>

            <div class="ayuda-seccion" data-section="arte">
                <h3>üé® Pesta√±a ARTE</h3>
                <p>En la pesta√±a ARTE puedes:</p>
                <ul>
                    <li>Ver una tabla completa de todos los equipos posibles</li>
                    <li>Ver los materiales necesarios para cada configuraci√≥n</li>
                    <li>Usar esta informaci√≥n para planificar tu progreso</li>
                </ul>
            </div>

            <div class="ayuda-seccion" data-section="responsive">
                <h3>üì± Dise√±o responsive</h3>
                <p>La aplicaci√≥n se adapta autom√°ticamente a diferentes dispositivos:</p>
                <ul>
                    <li><strong>Desktop:</strong> Interfaz completa con todos los elementos visibles</li>
                    <li><strong>Tablet:</strong> Elementos reorganizados para pantallas medianas</li>
                    <li><strong>M√≥vil:</strong> Interfaz optimizada para pantallas peque√±as</li>
                    <li><em>üí° Los selectores de materiales mantienen su forma cuadrada en todas las resoluciones</em></li>
                </ul>
            </div>

            <div class="ayuda-seccion" data-section="links">
                <h3>üîó Enlaces √∫tiles</h3>
                <p>√önete a nuestra comunidad:</p>
                <ul>
                    <li><strong>WhatsApp:</strong> Grupo de jugadores para consultas y estrategias</li>
                    <li><strong>Telegram:</strong> Canal oficial con noticias y actualizaciones</li>
                    <li><strong>YouTube:</strong> Tutoriales y contenido educativo</li>
                </ul>
            </div>
        </div>
        
        <!-- Layout igual que materiales pero ocultando galer√≠a y USAR -->
        <div class="bottom-section" id="bottom-section-ayuda">
            <!-- Espacio para mantener el layout -->
        </div>

        <div class="bottom-buttons">
            <button id="gallery-button-ayuda" class="gallery-button icon-button" title="Galer√≠a" style="display: none;">
                <span style="font-size: 22px;">üì∑</span>
            </button>
            
            <!-- Espacio para iconos sociales (se usar√°n los originales) -->
            <div class="social-icons-placeholder"></div>
            
            <button id="use-materials-ayuda" class="use-button" style="display: none;">USAR</button>
        </div>
        
        <!-- Bot√≥n Volver a Materiales -->
        <div class="ayuda-back-container">
            <button id="ayuda-back-button" class="back-button">‚Üê Volver a Materiales</button>
        </div>
    </div>

    <div class="bottom-section" id="bottom-section">
        <!-- Selectores de color por material se generar√°n din√°micamente -->
    </div>

    <div class="bottom-buttons">
        <button id="gallery-button" class="gallery-button icon-button" title="Galer√≠a">
            <span style="font-size: 22px;">üì∑</span>
        </button>
        
        <!-- Iconos de redes sociales -->
        <div class="social-icons">
            <a href="https://chat.whatsapp.com/DN5X1L7BqiJAMk4llRkLrN" target="_blank" class="social-icon" title="Grupo de WhatsApp - ‚öî ùêÆùêßùê¢ùê®ùêß ùêùùêû ùê°ùêûùê´ùê®ùêûùê¨ ‚öî">
                <img src="images/whatsapp.png" alt="WhatsApp" onerror="this.style.display='none'">
            </a>
            <a href="https://t.me/+MJ8GLGcdPX9iMTcx" target="_blank" class="social-icon" title="Grupo de Telegram - ‚öîÔ∏è ùêÆùêßùê¢ùê®ùêß ùêùùêû ùê°ùêûùê´ùê®ùêûùê¨ ‚öîÔ∏è">
                <img src="images/telegram.png" alt="Telegram" onerror="this.style.display='none'">
            </a>
            <a href="https://www.youtube.com/@DecodificandoDH" target="_blank" class="social-icon" title="Canal de YouTube - Decodificando DH">
                <img src="images/decodificando.png" alt="YouTube" onerror="this.style.display='none'">
            </a>
        </div>
        
        <button id="use-materials" class="use-button">USAR</button>
    </div>

    <!-- Modal para galer√≠a de im√°genes -->
    <div id="gallery-modal" class="modal">
        <div class="modal-content gallery-modal-content">
            <div class="modal-header">
                <h2>Galer√≠a de Im√°genes</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="gallery-container" class="gallery-container">
                    <!-- Las im√°genes se cargar√°n din√°micamente aqu√≠ -->
                </div>
                <input type="file" id="gallery-file-input" accept="image/*" style="display: none;">
                
                <!-- Bot√≥n Volver a Materiales -->
                <div class="gallery-back-container">
                    <button id="gallery-back-button" class="back-button">‚Üê Volver a Materiales</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para carrusel de im√°genes -->
    <div id="carousel-modal" class="modal">
        <div class="modal-content carousel-modal-content">
            <div class="carousel-container">
                <button class="carousel-nav prev" id="carousel-prev">‚Äπ</button>
                <div class="carousel-image-container">
                    <img id="carousel-image" src="" alt="Imagen actual">
                </div>
                <button class="carousel-nav next" id="carousel-next">‚Ä∫</button>
            </div>
            <div class="carousel-info">
                <span id="carousel-counter">1 / 1</span>
                <button class="carousel-close" id="carousel-close">√ó</button>
            </div>
        </div>
    </div>

    <!-- Modal para lista completa de materiales -->
    <div id="materials-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Lista Completa de Materiales</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="all-materials-table">
                    <!-- Tabla completa se generar√° din√°micamente -->
                </div>
            </div>
            <!-- Bot√≥n Volver -->
            <div class="modal-footer">
                <button id="materials-back-button" class="back-button">Volver</button>
            </div>
        </div>
    </div>

    <!-- Contenedor para notificaciones tipo toast -->
    <div id="toast-container">
        <!-- Plantilla para toasts (oculta por defecto) -->
        <div class="toast" id="toast-template" style="display: none;">
            <div class="toast-header">
                <strong class="toast-title"></strong>
                <button type="button" class="toast-close">&times;</button>
            </div>
            <div class="toast-body"></div>
        </div>
    </div>
</div>

<!-- === SCRIPTS === -->
<script type="module" src="scripts/app.js"></script>
<script type="module" src="scripts/backup.js"></script>

<script>
    // Animaci√≥n de iconos sociales con scroll
    function handleSocialIconsAnimation() {
        const socialIconsList = document.querySelectorAll('.social-icons');
        
        socialIconsList.forEach(socialIcons => {
            if (!socialIcons) return;

            const rect = socialIcons.getBoundingClientRect();
            const windowHeight = window.innerHeight;
            
            // Calcular cu√°ndo debe aparecer (cuando el elemento est√° a 200px de entrar en pantalla)
            const triggerPoint = windowHeight - 200;
            
            if (rect.top <= triggerPoint) {
                socialIcons.classList.add('reveal');
            }
        });
    }

    // Escuchar el evento de scroll
    window.addEventListener('scroll', handleSocialIconsAnimation);
    
    // Activar la animaci√≥n inmediatamente al cargar la p√°gina
    window.addEventListener('load', () => {
        const socialIconsList = document.querySelectorAll('.social-icons');
        
        socialIconsList.forEach(socialIcons => {
            if (socialIcons) {
                // Peque√±o delay para que se vea la animaci√≥n
                setTimeout(() => {
                    socialIcons.classList.add('reveal');
                }, 1000);
            }
        });
    });
    
    // Tambi√©n ejecutar al cargar la p√°gina por si ya est√° en la posici√≥n correcta
    window.addEventListener('load', handleSocialIconsAnimation);
</script>

</body>
</html>
